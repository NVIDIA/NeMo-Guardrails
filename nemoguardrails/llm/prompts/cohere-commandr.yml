# Prompts for Cohere Command-r.
prompts:
  - task: generate_user_intent
    models:
      - cohere/command-r
    messages:
      - type: system
        content: "{{ general_instructions }}"

      - type: system
        content: |-
          You are a helpful ai assistant. Your response should include three parts: User intent, Bot intent and Bot message.
          - User intent: <Extract user intent>
          - Bot intent: <Show what you think>
          - Bot message: <Actual response>
          Each part can only appear once.

      - "{{ sample_conversation | to_messages }}"

      - type: system
        content: "Answer user question with following part: User intent"

      - "{{ examples | to_messages}}"

      - type: system
        content: "Answer user question with following parts: User intent, Bot intent and Bot message."

      - "{{ sample_conversation | first_turns(2) | to_messages }}"
      - "{{ history | colang | to_messages }}"

    output_parser: "user_intent"

  - task: generate_user_intent
    models:
      - cohere/command-r
    messages:
      - type: system
        content: "{{ general_instructions }}"

      - type: system
        content: |- 
          You are a helpful ai assistant. Your response should include three parts: User intent, Bot intent and Bot message.
          - User intent: <Extract user intent>
          - Bot intent: <Show what you think>
          - Bot message: <Actual response>
          Each part can only appear once.

      - "{{ sample_conversation | first_turns(2) | to_messages }}"
      - "{{ history | colang | to_messages }}"

    mode: compact
    output_parser: "user_intent"

  - task: generate_next_steps
    models:
      - cohere/command-r
    messages:
      - type: system
        content: "{{ general_instructions }}"

      - type: system
        content: |- 
          You are a helpful ai assistant. Your response should include three parts: User intent, Bot intent and Bot message.
          - User intent: <Extract user intent>
          - Bot intent: <Show what you think>
          - Bot message: <Actual response>
          Each part can only appear once.

      - "{{ sample_conversation | to_messages }}"

      - type: system
        content: "Now show examples on how you think. Your response should include following parts: User intent and Bot intent."

      - "{{ examples | to_messages}}"

      - type: system
        content: "Answer user question with following parts: User intent, Bot intent and Bot message."

      - "{{ sample_conversation | first_turns(2) | to_messages }}"
      - "{{ history | colang | to_messages }}"

    output_parser: "bot_intent"

  - task: generate_bot_message
    models:
      - cohere/command-r
    messages:
      - type: system
        content: "{{ general_instructions }}"

      - type: system
        content: |- 
          You are a helpful ai assistant. Your response should include three parts: User intent, Bot intent and Bot message.
          - User intent: <Extract user intent>
          - Bot intent: <Show what you think>
          - Bot message: <Actual response>
          Each part can only appear once.

      - "{{ sample_conversation | to_messages }}"

      - type: system
        content: |-
          {% if relevant_chunks %}
          # This is some additional context:
          ```markdown
          {{ relevant_chunks }}
          ```
          {% endif %}"

      - type: system
        content: "Now show examples on how you think and answer. Your response should include following parts: Bot intent and Bot message."

      - "{{ examples | to_messages}}"

      - type: system
        content: "Answer user question with following parts: User intent, Bot intent and Bot message."

      - "{{ sample_conversation | first_turns(2) | to_messages }}"
      - "{{ history | colang | to_messages }}"
      - type: system
        content: Your respond lacks Bot message part. Provide no excuses or comments, just provide the Bot message part.

    output_parser: "bot_message"

  - task: generate_value
    models:
      - cohere/command-r
    messages:
      - type: system
        content: "{{ general_instructions }}"

      - type: system
        content: |- 
          You are a helpful ai assistant. Your response should include three parts: User intent, Bot intent and Bot message.
          - User intent: <Extract user intent>
          - Bot intent: <Show what you think>
          - Bot message: <Actual response>
          Each part can only appear once.

      - "{{ sample_conversation | to_messages }}"

      - type: system
        content: "Answer user question with following parts: User intent and Bot intent."

      - "{{ examples | to_messages}}"

      - type: system
        content: "Answer user question with following parts: User intent, Bot intent and Bot message."

      - "{{ sample_conversation | first_turns(2) | to_messages }}"
      - "{{ history | colang | to_messages }}"

      - type: system
        content: |-
          {{ instructions }}

      - type: assistant
        content: "${{ var_name }} ="
